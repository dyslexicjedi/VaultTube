{% extends "base.html" %}
{% block content %}


<div class="row row-cols-3 row-cols-md-1 g-4 pt-4" id="carddeck"></div>

<nav aria-label="..." class="pt-4 pb-4">
    <ul id="pagelist" class="pagination"></ul>
</nav>


<script>
    pagination(1);
    function get_channels(currentpage){
        $.getJSON("/api/channels/"+(currentpage*40),function(data){
            processdata(data);
        });
    }
    function processdata(data){
        $("#carddeck").empty();
        $.each(data,function(i,item){
            var jobj = jQuery.parseJSON(data[i]["json"]);
            var txt = "<div class=\"card\"><div class=\"card-body\"><a href=\"creator.html?creator="+data[i]['channelid']+"\">"+data[i]['channelname']+"</a></div><div><p>"+jobj['items'][0]['snippet']['description']+"</p></div>";
            txt += "<div class=\"card-footer d-flex flex-row bd-highlight mb-3 btn-toolbar\" role=\"toolbar\"><div class=\"btn-group\"><button class=\"btn btn-primary\">Subscribe</button></div><div class=\"input-group-text\">Video Count: "+data[i]['vidcount']+"</div><div class=\"input-group-text\">Last Video Archived: "+data[i]['lastvidtime']+"</div></div>";
            $("#carddeck").append(txt);
        });
    }
    function pagination(id){
        //ToDO
        //Get Videos
        get_channels(id-1);
        //Set Pagination buttons
        $("#pagelist").empty();
        var txt = "";
        if(id == 1){
            txt += "<li class=\"page-item disabled\"><a class=\"page-link\" href=\"#\">Previous</a></li>";
        }
        else{
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id-1)+");\">Previous</a></li>";
        }
        if(id < 4){
            if(id == 1){
                txt += "<li class=\"page-item active\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(1);\">1</a></li>";
            }
            else{
                txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(1);\">1</a></li>";
            }
            if(id == 2){
                txt += "<li class=\"page-item active\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(2);\">2</a></li>";
            }
            else{
                txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(2);\">2</a></li>";
            }
            if(id == 3){
                txt += "<li class=\"page-item active\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(3);\">3</a></li>";
            }
            else{
                txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(3);\">3</a></li>";
            }
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(4);\">4</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination(5);\">5</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id+1)+");\">Next</a></li>";
        }
        else{
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id-2)+");\">"+(id-2)+"</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id-1)+");\">"+(id-1)+"</a></li>";
            txt += "<li class=\"page-item active\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+id+");\">"+id+"</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id+1)+");\">"+(id+1)+"</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id+2)+");\">"+(id+2)+"</a></li>";
            txt += "<li class=\"page-item\"><a class=\"page-link\" href=\"#\" onclick=\"pagination("+(id+1)+");\">Next</a></li>";
        }
        $("#pagelist").append(txt);
        
    }

</script>

{% endblock %}